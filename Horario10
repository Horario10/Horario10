<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>7ª B | Dashboard Ultra + Gemini AI</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #ff3e3e;
            --accent: #ff0055;
            --glass: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --text: #ffffff;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Outfit', sans-serif; }

        body {
            background: #0f0c29;
            background: linear-gradient(45deg, #0f0c29, #302b63, #24243e);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .blob {
            position: fixed; width: 500px; height: 500px; background: var(--primary);
            filter: blur(80px); border-radius: 50%; z-index: -1; opacity: 0.2;
            animation: move 20s infinite alternate;
        }

        @keyframes move { from { transform: translate(-20%, -20%); } to { transform: translate(20%, 20%); } }

        header { width: 100%; padding: 40px 20px; text-align: center; }
        .class-title { font-size: 0.9rem; text-transform: uppercase; letter-spacing: 5px; color: var(--primary); }
        #clock { font-size: 6rem; font-weight: 900; text-shadow: 0 0 30px rgba(255, 62, 62, 0.5); }
        #date-text { opacity: 0.6; font-size: 1.1rem; }

        /* HERO CARD */
        .hero-container { width: 90%; max-width: 900px; margin-top: 20px; }
        .status-hero {
            background: var(--glass); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            border: 1px solid var(--glass-border); border-radius: 30px; padding: 50px; text-align: center;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3); position: relative; overflow: hidden;
        }
        .prof-name { font-size: 4rem; font-weight: 900; margin: 10px 0; }
        .progress-container { width: 100%; height: 8px; background: rgba(255,255,255,0.1); border-radius: 10px; margin: 20px 0; overflow: hidden; }
        .progress-bar { height: 100%; background: linear-gradient(90deg, var(--primary), var(--accent)); width: 0%; transition: width 1s linear; }

        /* UPCOMING LIST */
        .main-content { width: 90%; max-width: 900px; margin: 50px 0; }
        .upcoming-grid { display: grid; gap: 15px; }
        .upcoming-card {
            background: var(--glass); border: 1px solid var(--glass-border); padding: 20px;
            border-radius: 20px; display: flex; justify-content: space-between; align-items: center;
        }

        /* CHATBOT UI */
        #chat-wrapper { position: fixed; bottom: 20px; right: 20px; z-index: 1000; display: flex; flex-direction: column; align-items: flex-end; }
        #chat-container {
            width: 320px; height: 450px; background: rgba(15, 12, 41, 0.95); backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border); border-radius: 20px; margin-bottom: 15px;
            display: none; flex-direction: column; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        #chat-header { background: var(--primary); padding: 15px; font-weight: 600; display: flex; justify-content: space-between; }
        #chat-messages { flex: 1; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; font-size: 0.9rem; }
        .msg { padding: 8px 12px; border-radius: 12px; max-width: 85%; line-height: 1.4; }
        .msg.bot { background: var(--glass); align-self: flex-start; }
        .msg.user { background: var(--primary); align-self: flex-end; }
        #chat-input-area { padding: 10px; display: flex; gap: 5px; border-top: 1px solid var(--glass-border); }
        #chat-input { background: transparent; border: 1px solid var(--glass-border); color: white; padding: 10px; border-radius: 10px; flex: 1; outline: none; }
        #chat-trigger { width: 60px; height: 60px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; box-shadow: 0 5px 15px rgba(255, 62, 62, 0.4); }

        footer { padding: 60px; text-align: center; }
        .creator-name { font-size: 2rem; font-weight: 900; letter-spacing: 10px; opacity: 0.5; }
    </style>
</head>
<body>

<div class="blob"></div>

<header>
    <span class="class-title">Status da Sala - 7ª B</span>
    <div id="clock">00:00:00</div>
    <div id="date-text">--</div>
</header>

<div class="hero-container">
    <div class="status-hero">
        <p class="prof-label">Aula em andamento</p>
        <h2 id="main-prof" class="prof-name">--</h2>
        <p id="main-subject" class="subject-now">Aguardando...</p>
        <div class="progress-container">
            <div id="main-progress" class="progress-bar"></div>
        </div>
        <div id="main-timer" class="time-badge">OFFLINE</div>
    </div>
</div>

<div class="main-content">
    <h3 style="margin-bottom: 20px;">Cronograma do dia</h3>
    <div id="upcoming-list" class="upcoming-grid"></div>
</div>

<div id="chat-wrapper">
    <div id="chat-container">
        <div id="chat-header">
            <span>Assistente Gemini 7ª B</span>
            <span style="cursor:pointer" onclick="toggleChat()">×</span>
        </div>
        <div id="chat-messages">
            <div class="msg bot">E aí! Sou o Gemini. Pode perguntar sobre as aulas de hoje!</div>
        </div>
        <div id="chat-input-area">
            <input type="text" id="chat-input" placeholder="Que aula temos agora?">
            <button onclick="handleUserMessage()" style="background:var(--primary); border:none; color:white; padding:10px; border-radius:10px; cursor:pointer;">➔</button>
        </div>
    </div>
    <div id="chat-trigger" onclick="toggleChat()">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/></svg>
    </div>
</div>

<footer>
    <div class="creator-name">GERMANO</div>
</footer>

<script>
    const schedule = {
        1: [{s:"07:30",e:"08:20",t:"História",p:"Francielle"},{s:"08:20",e:"09:10",t:"História",p:"Francielle"},{s:"09:10",e:"09:30",t:"INTERVALO",p:"Pátio",b:true},{s:"09:30",e:"10:20",t:"Matemática",p:"Denice"},{s:"10:20",e:"11:10",t:"Matemática",p:"Denice"},{s:"11:10",e:"12:00",t:"P.T.",p:"Ana Paula"},{s:"12:00",e:"12:50",t:"Ciências",p:"Valdemar"}],
        2: [{s:"07:30",e:"08:20",t:"Gramática",p:"Adília"},{s:"08:20",e:"09:10",t:"Intel. Cria. e Dig.",p:"Flávia"},{s:"09:10",e:"09:30",t:"INTERVALO",p:"Pátio",b:true},{s:"09:30",e:"10:20",t:"Matemática",p:"Denice"},{s:"10:20",e:"11:10",t:"Ed. Física",p:"Marcelo"},{s:"11:10",e:"12:00",t:"Laboratório",p:"Mª Catarina"}],
        3: [{s:"07:30",e:"08:20",t:"Inglês",p:"Mônica"},{s:"08:20",e:"09:10",t:"Artes",p:"Claudio"},{s:"09:10",e:"09:30",t:"INTERVALO",p:"Pátio",b:true},{s:"09:30",e:"10:20",t:"Ciências",p:"Valdemar"},{s:"10:20",e:"11:10",t:"P.T.",p:"Ana Paula"},{s:"11:10",e:"12:00",t:"Ed. Física",p:"Marcelo"}],
        4: [{s:"07:30",e:"08:20",t:"Prat. Leit. e Escrita",p:"Paula M."},{s:"08:20",e:"09:10",t:"Oficina de Inglês",p:"Priscila"},{s:"09:10",e:"09:30",t:"INTERVALO",p:"Pátio",b:true},{s:"09:30",e:"10:20",t:"Inglês",p:"Mônica"},{s:"10:20",e:"11:10",t:"Gramática",p:"Adília"},{s:"11:10",e:"12:00",t:"Gramática",p:"Adília"}],
        5: [{s:"07:30",e:"08:20",t:"P.T.",p:"Ana Paula"},{s:"08:20",e:"09:10",t:"Geografia",p:"Wilson"},{s:"09:10",e:"09:30",t:"INTERVALO",p:"Pátio",b:true},{s:"09:30",e:"10:20",t:"Geografia",p:"Wilson"},{s:"10:20",e:"11:10",t:"Matemática",p:"Denice"},{s:"11:10",e:"12:00",t:"Matemática",p:"Denice"}]
    };

    const API_KEY = "299560cafe16094f3174158f8d68e7162662bf93";
    const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`;

    function update() {
        const now = new Date();
        const day = now.getDay();
        const timeNow = (now.getHours() * 3600) + (now.getMinutes() * 60) + now.getSeconds();

        document.getElementById('clock').textContent = now.toLocaleTimeString('pt-BR');
        document.getElementById('date-text').textContent = now.toLocaleDateString('pt-BR', {weekday: 'long', day: 'numeric', month: 'long'});

        if (!schedule[day]) {
            document.getElementById('main-prof').textContent = "DESCANSO";
            return;
        }

        let currentFound = false;
        let upcomingHTML = "";

        schedule[day].forEach(c => {
            const [sH, sM] = c.s.split(':').map(Number);
            const [eH, eM] = c.e.split(':').map(Number);
            const sSec = (sH * 3600) + (sM * 60);
            const eSec = (eH * 3600) + (eM * 60);

            if (timeNow >= sSec && timeNow < eSec) {
                document.getElementById('main-prof').textContent = c.p;
                document.getElementById('main-subject').textContent = c.t;
                const perc = ((timeNow - sSec) / (eSec - sSec)) * 100;
                document.getElementById('main-progress').style.width = perc + "%";
                const rem = eSec - timeNow;
                document.getElementById('main-timer').textContent = `FALTAM ${Math.floor(rem/60)}m ${rem%60}s`;
                currentFound = true;
            }

            if (timeNow < sSec) {
                upcomingHTML += `<div class="upcoming-card"><div><h4>${c.t}</h4><p>${c.p} • ${c.s}</p></div><div class="countdown">EM ${Math.floor((sSec-timeNow)/60)} MIN</div></div>`;
            }
        });

        if (!currentFound) {
            document.getElementById('main-prof').textContent = "FORA DE AULA";
            document.getElementById('main-progress').style.width = "0%";
        }
        document.getElementById('upcoming-list').innerHTML = upcomingHTML || "<p>Fim do expediente!</p>";
    }

    function toggleChat() {
        const chat = document.getElementById('chat-container');
        chat.style.display = chat.style.display === 'flex' ? 'none' : 'flex';
    }

    function addMessage(text, side, id = null) {
        const msg = document.createElement('div');
        msg.className = `msg ${side}`;
        if(id) msg.id = id;
        msg.textContent = text;
        document.getElementById('chat-messages').appendChild(msg);
        document.getElementById('chat-messages').scrollTop = document.getElementById('chat-messages').scrollHeight;
    }

    async function handleUserMessage() {
        const input = document.getElementById('chat-input');
        const text = input.value.trim();
        if(!text) return;

        addMessage(text, 'user');
        input.value = '';
        const tid = "t-" + Date.now();
        addMessage("...", "bot", tid);

        try {
            const context = `Você é o assistente da sala 7ª B. Seja engraçado e direto. Dados da sala: ${JSON.stringify(schedule)}`;
            const resp = await fetch(API_URL, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ contents: [{ parts: [{ text: `${context}\nPergunta: ${text}` }] }] })
            });
            const data = await resp.json();
            document.getElementById(tid).textContent = data.candidates[0].content.parts[0].text;
        } catch (e) {
            document.getElementById(tid).textContent = "Erro na conexão. A API está ativa?";
        }
    }

    document.getElementById('chat-input').addEventListener('keypress', (e) => e.key === 'Enter' && handleUserMessage());
    setInterval(update, 1000);
    update();
</script>
</body>
</html>
