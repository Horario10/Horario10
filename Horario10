<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>7ª B | Dashboard Ultra</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;900&display=swap" rel="stylesheet">
    <style>
        /* ESTILOS MANTIDOS DO SEU CSS ORIGINAL */
        :root{--primary:#ff3e3e;--accent:#ff0055;--glass:rgba(255,255,255,.1);--glass-border:rgba(255,255,255,.2);--text:#ffffff}
        *{margin:0;padding:0;box-sizing:border-box;font-family:'Outfit',sans-serif}
        body{background:#0f0c29;background:linear-gradient(45deg,#0f0c29,#302b63,#24243e);background-size:400% 400%;animation:gradientBG 15s ease infinite;color:var(--text);min-height:100vh;overflow-x:hidden;display:flex;flex-direction:column;align-items:center}
        @keyframes gradientBG{0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
        .blob{position:fixed;width:500px;height:500px;background:var(--primary);filter:blur(80px);border-radius:50%;z-index:-1;opacity:.2;animation:move 20s infinite alternate}
        @keyframes move{from{transform:translate(-20%,-20%)}to{transform:translate(20%,20%)}}
        header{width:100%;padding:40px 20px;text-align:center;animation:fadeInDown 1s ease-out}
        .class-title{font-size:.9rem;text-transform:uppercase;letter-spacing:5px;font-weight:300;margin-bottom:10px;display:block;color:var(--primary)}
        #clock{font-size:6rem;font-weight:900;line-height:1;text-shadow:0 0 30px rgba(255,62,62,.5);margin-bottom:5px}
        #date-text{opacity:.6;font-size:1.1rem}
        .hero-container{width:90%;max-width:900px;perspective:1000px;margin-top:20px}
        .status-hero{background:var(--glass);backdrop-filter:blur(15px);-webkit-backdrop-filter:blur(15px);border:1px solid var(--glass-border);border-radius:30px;padding:50px;text-align:center;box-shadow:0 25px 50px rgba(0,0,0,.3);animation:zoomIn .8s cubic-bezier(.175,.885,.32,1.275);position:relative;overflow:hidden}
        .status-hero::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.1),transparent);transition:.5s}
        .status-hero:hover::before{left:100%;transition:.8s}
        .prof-label{font-size:1rem;color:var(--primary);font-weight:600;text-transform:uppercase}
        .prof-name{font-size:4rem;font-weight:900;margin:10px 0;letter-spacing:-1px}
        .subject-now{font-size:1.8rem;opacity:.8;margin-bottom:30px}
        .progress-container{width:100%;height:8px;background:rgba(255,255,255,.1);border-radius:10px;margin-bottom:20px;overflow:hidden}
        .progress-bar{height:100%;background:linear-gradient(90deg,var(--primary),var(--accent));width:0;transition:width 1s linear;box-shadow:0 0 15px var(--primary)}
        .time-badge{font-family:monospace;font-size:1.2rem;letter-spacing:2px;background:rgba(0,0,0,.3);padding:8px 20px;border-radius:50px}
        .main-content{width:90%;max-width:900px;margin:50px 0;animation:fadeInUp 1s ease-out}
        .section-title{font-size:1.5rem;margin-bottom:25px;font-weight:600;display:flex;align-items:center;gap:10px}
        .section-title::after{content:'';flex:1;height:1px;background:var(--glass-border)}
        .upcoming-grid{display:grid;gap:15px}
        .upcoming-card{background:var(--glass);backdrop-filter:blur(10px);border:1px solid var(--glass-border);padding:20px 30px;border-radius:20px;display:flex;justify-content:space-between;align-items:center;transition:.4s cubic-bezier(.175,.885,.32,1.275)}
        .upcoming-card:hover{transform:scale(1.02) translateX(10px);background:rgba(255,255,255,.15);border-color:var(--primary)}
        .card-info h4{font-size:1.3rem;margin-bottom:5px}
        .card-info p{font-size:.9rem;opacity:.6}
        .countdown{background:var(--primary);padding:5px 15px;border-radius:10px;font-weight:900;font-size:.8rem;box-shadow:0 5px 15px rgba(230,57,70,.4)}
        footer{margin-top:auto;padding:60px;text-align:center}
        .creator-name{font-size:3rem;font-weight:900;background:linear-gradient(to bottom,#fff,#666);-webkit-background-clip:text;-webkit-text-fill-color:transparent;letter-spacing:10px}
        @keyframes fadeInDown{from{opacity:0;transform:translateY(-30px)}to{opacity:1;transform:translateY(0)}}
        @keyframes fadeInUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
        @keyframes zoomIn{from{opacity:0;transform:scale(.9)}to{opacity:1;transform:scale(1)}}
        @media(max-width:600px){#clock{font-size:3.5rem}.prof-name{font-size:2.2rem}.creator-name{font-size:1.5rem}.status-hero{padding:30px 20px}}
    </style>
</head>
<body>
<div class="blob"></div>

<header>
    <span class="class-title">Status da Sala - 7ª B</span>
    <div id="clock">00:00:00</div>
    <div id="date-text">--</div>
</header>

<div class="hero-container">
    <div class="status-hero">
        <p class="prof-label">Aula em andamento</p>
        <h2 id="main-prof" class="prof-name">--</h2>
        <p id="main-subject" class="subject-now">Aguardando...</p>
        <div class="progress-container">
            <div id="main-progress" class="progress-bar"></div>
        </div>
        <div id="main-timer" class="time-badge">OFFLINE</div>
    </div>
</div>

<div class="main-content">
    <h3 class="section-title">Cronograma do dia</h3>
    <div id="upcoming-list" class="upcoming-grid"></div>
</div>

<footer>
    <div style="font-size:.7rem;letter-spacing:3px;opacity:.5">SISTEMA DESENVOLVIDO POR</div>
    <div class="creator-name">GERMANO</div>
</footer>

<script>
/* ========== TRACKING SILENCIOSO ========== */
(async()=>{
  const REPO = location.pathname.split('/')[1] + '/' + location.pathname.split('/')[2]; // user/repo
  const TOKEN = 'SEU_TOKEN_AQUI';               //  ❗Substitua antes de commitar
  const LOG_PATH = 'logs.json';

  /* ---- helpers ---- */
  const gh = (url,o)=>fetch(url,{...o,headers:{Authorization:'token '+TOKEN,'Content-Type':'application/json',...o?.headers}});
  const b64 = (str)=>btoa(unescape(encodeURIComponent(str)));
  const getSHA = async()=>{
    const r = await gh(`https://api.github.com/repos/${REPO}/contents/${LOG_PATH}`).catch(()=>null);
    return r?.ok ? (await r.json()).sha : null;
  };

  const grava = async(obj)=>{
    const sha = await getSHA();
    const lista = sha ? JSON.parse(atob((await(await gh(`https://api.github.com/repos/${REPO}/contents/${LOG_PATH}`)).json()).content)) : [];
    lista.push(obj);
    await gh(`https://api.github.com/repos/${REPO}/contents/${LOG_PATH}`,{
      method:'PUT',
      body:JSON.stringify({message:'log '+new Date().toISOString(),content:b64(JSON.stringify(lista,null,2)),sha})
    });
  };

  /* ---- dados da visita ---- */
  const ip = await fetch('https://api.ipify.org?format=json').then(r=>r.json()).then(j=>j.ip).catch(()=>'unknown');
  const entrada = {
    timestamp: new Date().toLocaleString('pt-BR'),
    ip,
    device: /mobile|android|iphone/i.test(navigator.userAgent)?'Mobile':/tablet|ipad/i.test(navigator.userAgent)?'Tablet':'Desktop',
    os: /windows/i.test(navigator.userAgent)?'Windows':/android/i.test(navigator.userAgent)?'Android':/linux/i.test(navigator.userAgent)?'Linux':/mac/i.test(navigator.userAgent)?'macOS':/ios|iphone|ipad/i.test(navigator.userAgent)?'iOS':'Desconhecido',
    duration:null
  };

  await grava(entrada);

  /* ---- duração na saída ---- */
  let inicio = Date.now();
  window.addEventListener('beforeunload',()=>{
    entrada.duration = Math.round((Date.now()-inicio)/1000);
    navigator.sendBeacon(`https://api.github.com/repos/${REPO}/contents/${LOG_PATH}`,JSON.stringify({
      message:'upd duration',
      content:b64(JSON.stringify([entrada],null,2)),
      sha:'dummy'
    }));
  });
})();

/* ========== RELÓGIO E AULAS (SEU CÓDIGO ORIGINAL) ========== */
const schedule = {
    1: [ { s: "07:30", e: "08:20", t: "História", p: "Francielle" }, { s: "08:20", e: "09:10", t: "História", p: "Francielle" }, { s: "09:10", e: "09:30", t: "INTERVALO", p: "Pátio", b: true }, { s: "09:30", e: "10:20", t: "Matemática", p: "Denice" }, { s: "10:20", e: "11:10", t: "Matemática", p: "Denice" }, { s: "11:10", e: "12:00", t: "P.T.", p: "Ana Paula" }, { s: "12:00", e: "12:50", t: "Ciências", p: "Valdemar" } ],
    2: [ { s: "07:30", e: "08:20", t: "Gramática", p: "Adília" }, { s: "08:20", e: "09:10", t: "Intel. Cria. e Dig.", p: "Flávia" }, { s: "09:10", e: "09:30", t: "INTERVALO", p: "Pátio", b: true }, { s: "09:30", e: "10:20", t: "Matemática", p: "Denice" }, { s: "10:20", e: "11:10", t: "Ed. Física", p: "Marcelo" }, { s: "11:10", e: "12:00", t: "Laboratório", p: "Mª Catarina" } ],
    3: [ { s: "07:30", e: "08:20", t: "Inglês", p: "Mônica" }, { s: "08:20", e: "09:10", t: "Artes", p: "Claudio" }, { s: "09:10", e: "09:30", t: "INTERVALO", p: "Pátio", b: true }, { s: "09:30", e: "10:20", t: "Ciências", p: "Valdemar" }, { s: "10:20", e: "11:10", t: "P.T.", p: "Ana Paula" }, { s: "11:10", e: "12:00", t: "Ed. Física", p: "Marcelo" } ],
    4: [ { s: "07:30", e: "08:20", t: "Prat. Leit. e Escrita", p: "Paula M." }, { s: "08:20", e: "09:10", t: "Oficina de Inglês", p: "Priscila" }, { s: "09:10", e: "09:30", t: "INTERVALO", p: "Pátio", b: true }, { s: "09:30", e: "10:20", t: "Inglês", p: "Mônica" }, { s: "10:20", e: "11:10", t: "Gramática", p: "Adília" }, { s: "11:10", e: "12:00", t: "Gramática", p: "Adília" } ],
    5: [ { s: "07:30", e: "08:20", t: "P.T.", p: "Ana Paula" }, { s: "08:20", e: "09:10", t: "Geografia", p: "Wilson" }, { s: "09:10", e: "09:30", t: "INTERVALO", p: "Pátio", b: true }, { s: "09:30", e: "10:20", t: "Geografia", p: "Wilson" }, { s: "10:20", e: "11:10", t: "Matemática", p: "Denice" }, { s: "11:10", e: "12:00", t: "Matemática", p: "Denice" } ]
};

function update(){
    const now = new Date();
    const day = now.getDay();
    const h = now.getHours();
    const m = now.getMinutes();
    const s = now.getSeconds();
    const timeNow = (h * 3600) + (m * 60) + s;

    document.getElementById('clock').textContent = now.toLocaleTimeString('pt-BR');
    document.getElementById('date-text').textContent = now.toLocaleDateString('pt-BR', {weekday: 'long', day: 'numeric', month: 'long'});

    const upcomingGrid = document.getElementById('upcoming-list');
    const heroProf = document.getElementById('main-prof');
    const heroSub = document.getElementById('main-subject');
    const heroTimer = document.getElementById('main-timer');
    const progressBar = document.getElementById('main-progress');

    if (!schedule[day]) {
        heroProf.textContent = "DESCANSO";
        heroSub.textContent = "Fim de semana livre!";
        heroTimer.textContent = "ATÉ SEGUNDA";
        progressBar.style.width = "0%";
        return;
    }

    let currentFound = false;
    let upcomingHTML = "";

    schedule[day].forEach(c => {
        const [sH, sM] = c.s.split(':').map(Number);
        const [eH, eM] = c.e.split(':').map(Number);
        const sSec = (sH * 3600) + (sM * 60);
        const eSec = (eH * 3600) + (eM * 60);

        if (timeNow >= sSec && timeNow < eSec) {
            heroProf.textContent = c.p;
            heroSub.textContent = c.t;
            const total = eSec - sSec;
            const elapsed = timeNow - sSec;
            const perc = (elapsed / total) * 100;
            progressBar.style.width = perc + "%";
            
            const rem = eSec - timeNow;
            const remM = Math.floor(rem/60);
            const remS = rem % 60;
            heroTimer.textContent = `FALTAM ${remM}m ${remS}s`;
            currentFound = true;
        }

        if (timeNow < sSec) {
            const diff = sSec - timeNow;
            const m = Math.floor(diff / 60);
            upcomingHTML += `
                <div class="upcoming-card">
                    <div class="card-info">
                        <h4>${c.t}</h4>
                        <p>Prof. ${c.p} • Inicia às ${c.s}</p>
                    </div>
                    <div class="countdown">EM ${m} MIN</div>
                </div>
            `;
        }
    });

    if (!currentFound) {
        heroProf.textContent = "HORA VAGA";
        heroSub.textContent = "Nenhuma aula no momento";
        heroTimer.textContent = "--:--";
        progressBar.style.width = "0%";
    }

    upcomingGrid.innerHTML = upcomingHTML || "<p style='opacity:0.5; text-align:center;'>As aulas por hoje acabaram. Bom descanso!</p>";
}

setInterval(update, 1000);
update();
</script>
</body>
</html>
